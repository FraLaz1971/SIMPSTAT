1000 REM read data from BASIC file with DATA instructions
1005 LET PN$="COMPSTAT.BAS":LET CF=0: LET D=0
1010 REM OPEN PROGRAM1 FILE (R)
1020 OPEN "I",1,"SSTAT.BAS"
1030 REM OPEN DATA FILE (R)
1040 OPEN "I",2,"STATDATA.BAS"
1050 REM OPEN TOT PROGRAM FILE (W)
1060 OPEN "O",3,"TSTAT.BAS"
1070 LET N=1000: LET T$=""
1080 FOR L = 1 TO N
1090    IF EOF(1) THEN GOTO 1150
1100    ELSE
1120        LINE INPUT #1, T$
1125        PRINT #3, T$
1137        IF D=1 THEN M$="READ "+T$:GOSUB 2000
1140 NEXT L
1150 IF D=1 THEN M$="FILE ENDED":GOSUB 2000
1170 LET N=1000: LET T$=""
1180 FOR L = 1 TO N
1190    IF EOF(2) THEN GOTO 1250
1200    ELSE
1220        LINE INPUT #2, T$
1225        PRINT #3, T$
1235        IF D=1 THEN M$="READ "+T$:GOSUB 2000
1240 NEXT L
1250 IF D=1 THEN M$="FILE ENDED":GOSUB 2000
1270 CLOSE 1,2,3
1280 RUN "TSTAT.BAS"
1999 END
2000 REM FORMATTED MESSAGE ON TERMINAL
2020 PRINT DATE$;"|";TIME$;"|";PN$;"|";M$
2030 RETURN
4000 REM FORMATTED MESSAGE ON LOG FILE
4020 PRINT #4, DATE$;"|";TIME$;"|";PN$;"|";M$
4030 RETURN
